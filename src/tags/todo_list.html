<todo_list>
    <style>
    </style>
    <div riot-tag="todo_new"></div>
    <div each="{opts.results}">
        <input type="checkbox" value="" onclick="{finish_todo}" todo_id={objectId} checked="{finish}">{name}
    </div>
    <script>
        var self = this;
        console.log(self.opts);
        self.finish_todo = function (e) {
            var id = e.target.getAttribute('todo_id');
            var services = e.target.checked ? web.services.todo.finish : web.services.todo.unfinish;
            services(id, function (data) {
                if (data && data.code == 0) {
                    web.message('操作成功！');
                    $(e.target).parent().remove();
                } else {
                    web.message((data && data.message) || '操作失败！');
                }
            });
        };
        web.on('new_todo', function (data) {
            if (data && data.objectId) {
                self.opts.results.unshift(data);
                self.update();
            } else {
                web.message('新任务内容为空！');
            }
        });
    </script>
</todo_list>
