<header>
    <span if="{!user || !user.username}">Todo任务列表</span>
    <span if="{user && user.username}">
        <i class="glyphicon glyphicon-user"></i> {user.username}
    </span>
    <span class="pull-right" onclick="{login}" if="{!isLogin}">
        <i class="glyphicon glyphicon-log-in"></i> 登录
    </span>
    <span class="pull-right" onclick="{register}" if="{!isLogin}">
        <i class="glyphicon glyphicon-expand"></i> 注册
    </span>
    <span class="pull-right" if="{isLogin}" onclick="{logout}">
        <i class="glyphicon glyphicon-log-out"></i> 退出
    </span>

    <script>
        var self = this;
        self.login = function () {
            web.mount('login');
        };
        self.logout = function () {
            web.services.user.logout(function () {
                self.user = web.getUser();
                self.isLogin = !!self.user;
                self.update();
                web.trigger('update');
            });
        };

        self.register = function () {
            web.mount('register');
        };
        self.user = web.getUser();
        self.isLogin = !!self.user;
        web.on('login', function () {
            self.user = web.getUser();
            self.isLogin = !!self.user;
            self.update();
        });
        web.on('update', function () {
            self.user = web.getUser();
            self.isLogin = !!self.user;
            self.update();
        });
    </script>
</header>